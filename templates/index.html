<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OpenQP Web GUI</title>
    <script>
        async function loadGeometry() {
            const fileInput = document.getElementById("geometryFile");
            const formData = new FormData();
            formData.append("file", fileInput.files[0]);

            const response = await fetch("/load_geometry", {
                method: "POST",
                body: formData
            });
            const data = await response.json();
            document.getElementById("geometryContent").value = data.geometry_content;
        }

        async function saveGeometry() {
            const geometryContent = document.getElementById("geometryContent").value;
            const fileName = prompt("Enter file name", "geometry.xyz");

            const response = await fetch("/save_geometry", {
                method: "POST",
                headers: { "Content-Type": "application/x-www-form-urlencoded" },
                body: new URLSearchParams({ "geometry_content": geometryContent, "file_name": fileName })
            });
            const data = await response.json();
            alert(data.status);
        }

        async function generateInput() {
            const calcType = document.getElementById("calcType").value;
            const response = await fetch("/generate_input", {
                method: "POST",
                headers: { "Content-Type": "application/x-www-form-urlencoded" },
                body: new URLSearchParams({ "calc_type": calcType })
            });
            const data = await response.json();
            document.getElementById("inputContent").value = data.input_text;
        }

        async function submitJob() {
            const jobName = document.getElementById("jobName").value;
            const inputText = document.getElementById("inputContent").value;

            const response = await fetch("/submit_job", {
                method: "POST",
                headers: { "Content-Type": "application/x-www-form-urlencoded" },
                body: new URLSearchParams({ "job_name": jobName, "input_text": inputText })
            });
            const data = await response.json();
            alert(data.status);
        }
    </script>
</head>
<body>
    <h1>OpenQP Web GUI</h1>
    <div>
        <label>Load Geometry (XYZ format):</label>
        <input type="file" id="geometryFile" onchange="loadGeometry()">
        <button onclick="saveGeometry()">Save Geometry</button>
        <textarea id="geometryContent" rows="10" cols="30"></textarea>
    </div>
    <div>
        <label>Calculation Type:</label>
        <select id="calcType" onchange="generateInput()">
            <!-- Options populated from Flask backend -->
            {% for option in calc_options %}
                <option value="{{ option }}">{{ option }}</option>
            {% endfor %}
        </select>
    </div>
    <div>
        <label>Generated Input:</label>
        <textarea id="inputContent" rows="10" cols="40"></textarea>
    </div>
    <div>
        <label>Job Name:</label>
        <input type="text" id="jobName">
        <button onclick="submitJob()">Submit Job</button>
    </div>
</body>
</html>

